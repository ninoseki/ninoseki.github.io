(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{302:function(e,r,t){"use strict";t.r(r);var a=t(10),n=Object(a.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"page-title"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#page-title"}},[e._v("#")]),e._v(" "+e._s(e.$page.title))]),e._v(" "),r("p",[r("span",{staticStyle:{color:"#999"}},[e._v(e._s(e.$page.readingTime.text)+"...")])]),e._v(" "),r("p",[r("a",{attrs:{href:"https://www.antiphishing.jp/",target:"_blank",rel:"noopener noreferrer"}},[e._v("フィッシング対策協議会"),r("OutboundLink")],1),e._v("によれば、2018年上半期に報告されたフィッシングの件数は2017年下半期の月平均と比較して1.6倍に増加しているそうです。")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://i.imgur.com/P5dfL8v.png",alt:"Imgur"}}),e._v("\n(source: https://www.antiphishing.jp/news/pdf/apcseminar2018apc.pdf)")]),e._v(" "),r("p",[e._v("この記事では、増加するフィッシングに対して効率的に対応するため、ドメイン名を起点にフィッシングサイトを見つけ、それを報告するまでの流れについて紹介します。")]),e._v(" "),r("h2",{attrs:{id:"前段"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#前段"}},[e._v("#")]),e._v(" 前段")]),e._v(" "),r("p",[e._v("フィッシングをしかける攻撃者は、紛らわしいドメイン名(タイポスクワッティング / typosquatting)を用意し、そこにターゲットを誘導します。")]),e._v(" "),r("p",[e._v("例として、Apple ユーザーを標的にしたフィッシングサイトのドメイン名を以下に示します。")]),e._v(" "),r("ul",[r("li",[e._v("apple-appleidd[.]ddns[.]net")]),e._v(" "),r("li",[e._v("store-appleid-manage-subcriptionsdetail-support-new-home[.]com")]),e._v(" "),r("li",[e._v("web-appleid-secure-notified-home-base-database[.]com")])]),e._v(" "),r("p",[r("code",[e._v("apple")]),e._v(" や "),r("code",[e._v("appleid")]),e._v(" といったそれらしい単語がドメイン名に含まれていることがわかります。")]),e._v(" "),r("p",[e._v("新しく登録されたドメイン名をモニタリングし、上記の様にタイポスクワッティングなドメインがないか確認をすることでフィッシングサイトを見つけることができます。")]),e._v(" "),r("h3",{attrs:{id:"備考"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#備考"}},[e._v("#")]),e._v(" 備考")]),e._v(" "),r("ul",[r("li",[e._v("フィッシングサイトを見つける方法として、今回紹介する方法の他に "),r("a",{attrs:{href:"https://openphish.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenPhish"),r("OutboundLink")],1),e._v(" や "),r("a",{attrs:{href:"https://www.phishtank.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("PhishTank"),r("OutboundLink")],1),e._v(" のフィードをモニタリングする方法や "),r("a",{attrs:{href:"https://www.certificate-transparency.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Certificate Transparency"),r("OutboundLink")],1),e._v(" ログサーバーをモニタリングする方法がありますが、今回は割愛します。\n"),r("ul",[r("li",[e._v("参考:\n"),r("ul",[r("li",[r("a",{attrs:{href:"https://www.facebook.com/notes/protect-the-graph/detecting-phishing-domains-using-certificate-transparency/2037453483161459/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Facebook: Detecting phishing domains using Certificate Transparency"),r("OutboundLink")],1)])])])])]),e._v(" "),r("li",[e._v("最近のフィッシングの手口として、ドメインを取得せず、短縮 URL サービスを使用してフィッシングサイトへ誘導するものがあります。いわゆる smishing でよく使用されています。これについては、今回紹介する手法では発見することはできません。")])]),e._v(" "),r("h2",{attrs:{id:"_1-新しく登録されたドメイン名を見つける"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-新しく登録されたドメイン名を見つける"}},[e._v("#")]),e._v(" 1. 新しく登録されたドメイン名を見つける")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://www.domaintools.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("DomainTools"),r("OutboundLink")],1),e._v(" や "),r("a",{attrs:{href:"https://securitytrails.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("SecurityTrails"),r("OutboundLink")],1),e._v(" など、新規に登録されたドメイン名を有償で提供しているサービスがあります。")]),e._v(" "),r("p",[e._v("一方、"),r("a",{attrs:{href:"https://whoisds.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("WhoisDS"),r("OutboundLink")],1),e._v(", "),r("a",{attrs:{href:"https://wa-com.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("WebAnalyzer"),r("OutboundLink")],1),e._v(" や "),r("a",{attrs:{href:"https://dnpedia.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("DnPedia"),r("OutboundLink")],1),e._v(" など、無償で新規に登録されたドメイン名を提供しているサービスもあります。\nこの中でも、DnPeida は検索用のインターフェースを持っており、簡便に扱うことができます。")]),e._v(" "),r("p",[e._v("例えば、DnPedia の"),r("a",{attrs:{href:"https://dnpedia.com/tlds/search.php",target:"_blank",rel:"noopener noreferrer"}},[e._v("Domain Search"),r("OutboundLink")],1),e._v(" にて "),r("code",[e._v("yahoo")]),e._v(" で検索してみるとこのような結果になりました。")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://i.imgur.com/YGZzlql.png",alt:"Imgur"}})]),e._v(" "),r("p",[e._v("ぱっと見たところ、"),r("code",[e._v("yahoo-protect[.]info")]),e._v(" や "),r("code",[e._v("yahoo-maintain[.]com")]),e._v(" が怪しいですね。")]),e._v(" "),r("h2",{attrs:{id:"_2-フィッシングサイトか確認する"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-フィッシングサイトか確認する"}},[e._v("#")]),e._v(" 2. フィッシングサイトか確認する")]),e._v(" "),r("p",[e._v("タイポスクワッティングなドメイン名を見つけたら、それがフィッシングサイトかどうか確認してみましょう。")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://checkphish.ai",target:"_blank",rel:"noopener noreferrer"}},[e._v("CheckPhish.ai"),r("OutboundLink")],1),e._v(", "),r("a",{attrs:{href:"https://phishcheck.me/",target:"_blank",rel:"noopener noreferrer"}},[e._v("phishcheck.me"),r("OutboundLink")],1),e._v(" など、URL を入力することでフィッシングサイトかどうか判定してくれるサービスがあるので、これを使うと便利です。")]),e._v(" "),r("p",[e._v("また、"),r("a",{attrs:{href:"https://urlscan.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("urlscan.io"),r("OutboundLink")],1),e._v(" のような Web サイトを細かく分析するサービスを使用して確認することもできます。")]),e._v(" "),r("h3",{attrs:{id:"実例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#実例"}},[e._v("#")]),e._v(" 実例")]),e._v(" "),r("p",[e._v("では先ほど "),r("code",[e._v("yahoo")]),e._v(" で検索した際に怪しく見えた "),r("code",[e._v("yahoo-maintain[.]com")]),e._v(" を例に試してみましょう。")]),e._v(" "),r("h4",{attrs:{id:"checkphish-ai"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#checkphish-ai"}},[e._v("#")]),e._v(" CheckPhish.ai")]),e._v(" "),r("ul",[r("li",[e._v("https://checkphish.ai/insights/url/1548314631088/1fa757c8c76c2a6fb03b6ba673cd1afab14cc56ba3f39f3b1ccce80d9dbbd33a")])]),e._v(" "),r("p",[r("img",{attrs:{src:"https://i.imgur.com/BrWszEO.png",alt:"Imgur"}})]),e._v(" "),r("h4",{attrs:{id:"phishcheck-me"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#phishcheck-me"}},[e._v("#")]),e._v(" phishcheck.me")]),e._v(" "),r("ul",[r("li",[e._v("https://phishcheck.me/172512/details")])]),e._v(" "),r("p",[r("img",{attrs:{src:"https://i.imgur.com/VFnYw6S.png",alt:"Imgur"}})]),e._v(" "),r("h4",{attrs:{id:"urlscan-io"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#urlscan-io"}},[e._v("#")]),e._v(" urlscan.io")]),e._v(" "),r("ul",[r("li",[e._v("https://urlscan.io/domain/www.yahoo-maintain.com")])]),e._v(" "),r("p",[r("img",{attrs:{src:"https://i.imgur.com/PfsD8Qt.png",alt:"Imgur"}})]),e._v(" "),r("p",[e._v("スクリーンショットや HTML、入力フォームなどを確認することで、 Yahoo! Japan のID・パスワードおよびクレジットカード情報を盗み取ろうとするフィッシングサイトだと確認することできました。")]),e._v(" "),r("h3",{attrs:{id:"_2-1-web-サイトモニタリング"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-web-サイトモニタリング"}},[e._v("#")]),e._v(" 2.1 Web サイトモニタリング")]),e._v(" "),r("p",[e._v("上記のフィッシングサイトの確認方法は、リアルタイムでフィッシングサイトが稼働していることが前提となっています。")]),e._v(" "),r("p",[e._v("しかし、ドメイン名が登録されていることは、Web サイトが稼働していること(= IP アドレスが割り当てられ Web サーバーが稼働していること)を意味しません。ドメイン名が取得されて、しばらくしてから Web サイトが稼働することは往往にしてあることです。")]),e._v(" "),r("p",[e._v("タイポスクワッティングなドメイン名を見つけたけれど、そのドメイン名で Web サイトが稼働していなかった場合、下記のようなサービスを使ってモニタリングするのが良いでしょう。")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.statuscake.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("StatusCake"),r("OutboundLink")],1),e._v(" "),r("ul",[r("li",[e._v("無料で10サイトまでモニタリング可能")]),e._v(" "),r("li",[e._v("最短監視間隔: 5分")])])]),e._v(" "),r("li",[r("a",{attrs:{href:"https://pingbreak.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Pingbreak"),r("OutboundLink")],1),e._v(" "),r("ul",[r("li",[e._v("無料で20サイトまでモニタリング可能")]),e._v(" "),r("li",[e._v("最短監視間隔: 1分")])])]),e._v(" "),r("li",[r("a",{attrs:{href:"https://www.freshworks.com/website-monitoring/",target:"_blank",rel:"noopener noreferrer"}},[e._v("freshping"),r("OutboundLink")],1),e._v(" "),r("ul",[r("li",[e._v("無料で50サイトまでモニタリング可能")]),e._v(" "),r("li",[e._v("最短監視間隔: 1分")])])])]),e._v(" "),r("h2",{attrs:{id:"_3-フィッシングサイトを報告する"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-フィッシングサイトを報告する"}},[e._v("#")]),e._v(" 3. フィッシングサイトを報告する")]),e._v(" "),r("p",[e._v("まずは "),r("a",{attrs:{href:"https://safebrowsing.google.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Safe Browsing"),r("OutboundLink")],1),e._v(" に報告しましょう。")]),e._v(" "),r("p",[e._v("Google Safe Browsing は Chrome, Safari, Firefox といった主要ブラウザでサポートされています。Google Safe Browsing に報告することで、それらの主要ブラウザのユーザーをフィッシングサイトから守る手助けができます。")]),e._v(" "),r("p",[e._v("Google Safe Browsing にフィッシング報告をするのは簡単です。")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://safebrowsing.google.com/safebrowsing/report_phish/?hl=en",target:"_blank",rel:"noopener noreferrer"}},[e._v("Report Phishing Page"),r("OutboundLink")],1),e._v(" のフォームに フィッシングサイトの URL を記入してサブミットするだけで完了します。")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://i.imgur.com/AQouxwf.png",alt:"Imgur"}})]),e._v(" "),r("p",[e._v("また、"),r("a",{attrs:{href:"https://www.jpcert.or.jp/",target:"_blank",rel:"noopener noreferrer"}},[e._v("JPCERT/CC"),r("OutboundLink")],1),e._v(" に報告するものいいでしょう。")]),e._v(" "),r("p",[e._v("JPCERT/CC にも "),r("a",{attrs:{href:"https://form.jpcert.or.jp/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Web フォーム"),r("OutboundLink")],1),e._v("経由で簡単に報告することができます。")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://i.imgur.com/wJFun4d.png",alt:"Imgur"}})]),e._v(" "),r("p",[e._v("さらに進んで フィッシングサイトをホスティングしている ISP に報告する手もあります。これによりフィッシングサイトのテイクダウンにつながる可能性があります。")]),e._v(" "),r("p",[e._v("ISP の公式サイトを確認すれば、報告窓口(abuse 担当)が大抵の場合はわかるでしょう。また、"),r("a",{attrs:{href:"https://github.com/certsocietegenerale/abuse_finder",target:"_blank",rel:"noopener noreferrer"}},[e._v("certsocietegenerale/abuse_finder"),r("OutboundLink")],1),e._v(" というabuse 担当の連絡先を簡単に調べるためのツールもあります。")]),e._v(" "),r("h2",{attrs:{id:"おまけ"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#おまけ"}},[e._v("#")]),e._v(" おまけ")]),e._v(" "),r("p",[e._v("新しく登録されたドメイン名のチェックからフィッシング判定の途中までを自動化するツールを作成しました。")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/ninoseki/osakana",target:"_blank",rel:"noopener noreferrer"}},[e._v("ninoseki/osakana"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("このツールを使うことで、以下のタスクを自動化することができます。")]),e._v(" "),r("ul",[r("li",[e._v("DnPedia 上で特定のキーワードを検索")]),e._v(" "),r("li",[e._v("検索結果(特定のキーワードを含む新しく登録されたドメイン)を Slack にポスト")])]),e._v(" "),r("h3",{attrs:{id:"インストール"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#インストール"}},[e._v("#")]),e._v(" インストール")]),e._v(" "),r("p",[e._v("このツールは Ruby gem として配布しています。")]),e._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[e._v("$ gem "),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" osakana\n")])])]),r("h3",{attrs:{id:"実行例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#実行例"}},[e._v("#")]),e._v(" 実行例")]),e._v(" "),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[e._v("$ osakana check_newly_domains yahoo\n")])])]),r("p",[r("img",{attrs:{src:"https://i.imgur.com/ylFsgBu.png",alt:"Imgur"}})]),e._v(" "),r("p",[e._v("このように、特定のキーワードを含むドメインを簡単に確認することができます。")]),e._v(" "),r("p",[e._v("よろしければ使ってみてください。")])])}),[],!1,null,null,null);r.default=n.exports}}]);