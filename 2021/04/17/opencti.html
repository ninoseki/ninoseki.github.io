<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenCTI入門 | ninoseki.github.io</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="alternate" type="application/rss+xml" href="https://ninoseki.github.io/rss.xml" title="ninoseki.github.io RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://ninoseki.github.io/feed.atom" title="ninoseki.github.io Atom Feed">
    <link rel="alternate" type="application/json" href="https://ninoseki.github.io/feed.json" title="ninoseki.github.io JSON Feed">
    <meta name="description" content="(●__●)">
    <meta name="twitter:image">
    <meta property="og:url" content="https://ninoseki.github.io/_posts/2021-04-17-opencti.html">
    <meta name="twitter:url" content="https://ninoseki.github.io/_posts/2021-04-17-opencti.html">
    <meta property="og:title" content="OpenCTI入門">
    <meta name="twitter:title" content="OpenCTI入門">
    <meta itemprop="name" content="OpenCTI入門">
    <meta property="og:type" content="article">
    <meta name="twitter:card" content="summary">
    <meta property="og:site_name" content="ninoseki.github.io">
    
    <link rel="preload" href="/assets/css/0.styles.0313a152.css" as="style"><link rel="preload" href="/assets/js/app.c8db5b8a.js" as="script"><link rel="preload" href="/assets/js/2.551672f8.js" as="script"><link rel="preload" href="/assets/js/31.924c0225.js" as="script"><link rel="prefetch" href="/assets/js/10.93b31ecf.js"><link rel="prefetch" href="/assets/js/11.c7100068.js"><link rel="prefetch" href="/assets/js/12.581a6cb7.js"><link rel="prefetch" href="/assets/js/13.4a900d3a.js"><link rel="prefetch" href="/assets/js/14.35bc31c5.js"><link rel="prefetch" href="/assets/js/15.0c5932bf.js"><link rel="prefetch" href="/assets/js/16.299d6e84.js"><link rel="prefetch" href="/assets/js/17.bce521f0.js"><link rel="prefetch" href="/assets/js/18.27e8b041.js"><link rel="prefetch" href="/assets/js/19.e0c00b92.js"><link rel="prefetch" href="/assets/js/20.26e859db.js"><link rel="prefetch" href="/assets/js/21.b30f15e1.js"><link rel="prefetch" href="/assets/js/22.448af522.js"><link rel="prefetch" href="/assets/js/23.ed0bd195.js"><link rel="prefetch" href="/assets/js/24.ab2bb9e9.js"><link rel="prefetch" href="/assets/js/25.2c17fb30.js"><link rel="prefetch" href="/assets/js/26.5c975520.js"><link rel="prefetch" href="/assets/js/27.53eefe9e.js"><link rel="prefetch" href="/assets/js/28.989fe98b.js"><link rel="prefetch" href="/assets/js/29.ad8c9bc4.js"><link rel="prefetch" href="/assets/js/3.78dae79f.js"><link rel="prefetch" href="/assets/js/30.397b4d86.js"><link rel="prefetch" href="/assets/js/32.13b6de82.js"><link rel="prefetch" href="/assets/js/33.27cd3ddf.js"><link rel="prefetch" href="/assets/js/34.134325a9.js"><link rel="prefetch" href="/assets/js/35.7dc97dee.js"><link rel="prefetch" href="/assets/js/4.7d7fb440.js"><link rel="prefetch" href="/assets/js/5.b3da5054.js"><link rel="prefetch" href="/assets/js/6.5cee6874.js"><link rel="prefetch" href="/assets/js/7.1f1d02f6.js"><link rel="prefetch" href="/assets/js/8.b26ffa7b.js"><link rel="prefetch" href="/assets/js/9.79bb7ce1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0313a152.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ninoseki.github.io</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>OpenCTI入門</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2021/04/17/opencti.html#openctiとは" class="sidebar-link">OpenCTIとは</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#アーキテクチャ" class="sidebar-link">アーキテクチャ</a></li><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#ユースケース" class="sidebar-link">ユースケース</a></li></ul></li><li><a href="/2021/04/17/opencti.html#インストール" class="sidebar-link">インストール</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/2021/04/17/opencti.html#connectors" class="sidebar-link">Connectors</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#data-import" class="sidebar-link">Data import</a></li><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#stream-consumers" class="sidebar-link">Stream consumers</a></li><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#enrichment" class="sidebar-link">Enrichment</a></li><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#files-import" class="sidebar-link">Files import</a></li><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#file-export" class="sidebar-link">File export</a></li></ul></li><li><a href="/2021/04/17/opencti.html#利用方法" class="sidebar-link">利用方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#web-ui" class="sidebar-link">Web UI</a></li><li class="sidebar-sub-header"><a href="/2021/04/17/opencti.html#graphql-api" class="sidebar-link">GraphQL API</a></li></ul></li><li><a href="/2021/04/17/opencti.html#まとめ-あるいはopenctiは実際どう使えるのか" class="sidebar-link">まとめ(あるいはOpenCTIは実際どう使えるのか)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/2021/04/17/opencti.html#references" class="sidebar-link">References</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/2021/04/17/opencti.html#おまけ-oss-tip-matrix" class="sidebar-link">おまけ(OSS TIP matrix)</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="page-title"><a href="#page-title" class="header-anchor">#</a> OpenCTI入門</h1> <p><span style="color:#999;">2 min read...</span></p> <div class="custom-block tip"><p class="custom-block-title">Notes</p> <ul><li>本稿はOpenCTI v4.4.0をベースにして書かれている。</li></ul></div> <h2 id="openctiとは"><a href="#openctiとは" class="header-anchor">#</a> OpenCTIとは</h2> <ul><li>OpenCTIは、Luatixが開発しているOpen Cyber Threat Intelligence Platform.
<ul><li>Luatixは<a href="https://www.cert.ssi.gouv.fr/" target="_blank" rel="noopener noreferrer">ANSSI/CERT-FR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://cert.europa.eu/cert/filteredition/en/CERT-LatestNews.html" target="_blank" rel="noopener noreferrer">CERT-EU<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>がfounder membersになっている非営利組織。</li> <li>TainumやThalesがスポンサードしている。</li></ul></li></ul> <p><img src="https://i.imgur.com/vsDIPG0.png" alt=""></p> <ul><li>STIX2.1をベースにしたThreat Intelligenceのナレッジ管理を行うことができる。</li></ul> <p><img src="https://i.imgur.com/MSr1bAA.png" alt="">
(Source: <a href="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a435a173-bbfd-4dd8-99a7-1924b78945a6/20200415_OpenCTI_Webinar_001.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210416%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20210416T012752Z&amp;X-Amz-Expires=86400&amp;X-Amz-Signature=b6bea7fedf34d69818725d5140fc3bd7c9025a1144dedc97c87bc03c24ebf8ee&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=filename%20%3D%2220200415_OpenCTI_Webinar_001.pdf%22" target="_blank" rel="noopener noreferrer">OpenCTI Introduction to the platform &amp; next steps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <h3 id="アーキテクチャ"><a href="#アーキテクチャ" class="header-anchor">#</a> アーキテクチャ</h3> <p><img src="https://i.imgur.com/cCGIRmu.png" alt=""></p> <p>(Source: <a href="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a435a173-bbfd-4dd8-99a7-1924b78945a6/20200415_OpenCTI_Webinar_001.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210416%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20210416T012752Z&amp;X-Amz-Expires=86400&amp;X-Amz-Signature=b6bea7fedf34d69818725d5140fc3bd7c9025a1144dedc97c87bc03c24ebf8ee&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=filename%20%3D%2220200415_OpenCTI_Webinar_001.pdf%22" target="_blank" rel="noopener noreferrer">OpenCTI Introduction to the platform &amp; next steps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <h3 id="ユースケース"><a href="#ユースケース" class="header-anchor">#</a> ユースケース</h3> <h4 id="cert-eu"><a href="#cert-eu" class="header-anchor">#</a> CERT-EU</h4> <p><img src="https://i.imgur.com/sy5Hyeb.png" alt=""></p> <p><img src="https://i.imgur.com/Xe5vLXa.png" alt=""></p> <p>(Source: <a href="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a435a173-bbfd-4dd8-99a7-1924b78945a6/20200415_OpenCTI_Webinar_001.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210416%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20210416T012752Z&amp;X-Amz-Expires=86400&amp;X-Amz-Signature=b6bea7fedf34d69818725d5140fc3bd7c9025a1144dedc97c87bc03c24ebf8ee&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=filename%20%3D%2220200415_OpenCTI_Webinar_001.pdf%22" target="_blank" rel="noopener noreferrer">OpenCTI Introduction to the platform &amp; next steps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <h4 id="anssi"><a href="#anssi" class="header-anchor">#</a> ANSSI</h4> <p><img src="https://i.imgur.com/xKOvwn9.png" alt="">
(Source: <a href="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a435a173-bbfd-4dd8-99a7-1924b78945a6/20200415_OpenCTI_Webinar_001.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210416%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20210416T012752Z&amp;X-Amz-Expires=86400&amp;X-Amz-Signature=b6bea7fedf34d69818725d5140fc3bd7c9025a1144dedc97c87bc03c24ebf8ee&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=filename%20%3D%2220200415_OpenCTI_Webinar_001.pdf%22" target="_blank" rel="noopener noreferrer">OpenCTI Introduction to the platform &amp; next steps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <h2 id="インストール"><a href="#インストール" class="header-anchor">#</a> インストール</h2> <p>Dockerによるインストール方法は以下の通り。</p> <div class="language-bash= extra-class"><pre class="language-text"><code>$ git clone https://github.com/OpenCTI-Platform/docker.git
$ cd docker

# .envファイルのサンプルをコピー
$ cp .env.sample .env

# https://www.notion.so/Using-Docker-03d5c0592b9d4547800cc9f4ff7be2b8
# &quot;Configure the environment&quot;のセクションの指示に従い、`ChangeMe`の箇所を適当な値に書き換える
$ vim .env
</code></pre></div><p>これで<code>docker-compose up -d</code>をすればOpenCTIが<code>localhost:8080</code>で起動する。</p> <p><img src="https://i.imgur.com/srg3NyP.png" alt=""></p> <p>しかし、デフォルトの設定のままだと、使用できるConnectorが少ない。
(Connectorはプラグインのようなもので、外部サービスとOpenCTIのデータ連携に使用される。詳細は後述する。)</p> <p><img src="https://i.imgur.com/REmSroJ.png" alt=""></p> <p>Connectorの一覧を確認し、利用できるConnectorがあれば有効化してみよう。</p> <p>Connectorは下記のリポジトリで管理されている。</p> <ul><li><a href="https://github.com/OpenCTI-Platform/connectors" target="_blank" rel="noopener noreferrer">OpenCTI-Platform/connectors<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>Connectorの概要を把握するためには、下記のWebページを参照した方が分かりやすいかもしれない。</p> <ul><li><a href="https://www.notion.so/868329e9fb734fca89692b2ed6087e76" target="_blank" rel="noopener noreferrer">OpenCTI Ecosystem<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><img src="https://i.imgur.com/cqwtLrt.png" alt=""></p> <p>例えば<a href="https://malpedia.caad.fkie.fraunhofer.de/" target="_blank" rel="noopener noreferrer">Maplpedia<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>のConnectorを有効にしたい場合、下記のように<code>docker-compose.yml</code>にConnector用の設定を追加すれば良い。</p> <p><img src="https://i.imgur.com/nIHFEkE.png" alt=""></p> <p>あるいは個別に(メインの<code>docker-compose.yml</code>の外で)Connectorを動かすこともできる。</p> <div class="language-bash= extra-class"><pre class="language-text"><code>$ wget &lt;https://github.com/OpenCTI-Platform/connectors/archive/{RELEASE_VERSION}.zip&gt;
$ unzip {RELEASE_VERSION}.zip
$ cd connectors-{RELEASE_VERSION}/{CONNECTOR_NAME}/

$ vim docker-compose.yml
$ docker-compose up -d
</code></pre></div><p>しかし、管理の面からすると、1つの<code>docker-compose.yml</code>にまとめておいた方が楽だろう。</p> <h2 id="connectors"><a href="#connectors" class="header-anchor">#</a> Connectors</h2> <p>Connectorには<code>Data import</code>, <code>Stream consumers</code>, <code>Enrichment</code>, <code>File import</code>, <code>File export</code>の5種類がある。</p> <h3 id="data-import"><a href="#data-import" class="header-anchor">#</a> Data import</h3> <p>Data import用のConnectorは、外部サービスからデータをインポートする機能を持っている。</p> <p>例えばMalepdiaのConnectorを使うと、(デフォルトの設定のままだと)1日1回Malpediaからデータをインポートすることができる。</p> <p><img src="https://i.imgur.com/BKrC3qY.png" alt=""></p> <p><img src="https://i.imgur.com/HmUc4nu.png" alt=""></p> <h3 id="stream-consumers"><a href="#stream-consumers" class="header-anchor">#</a> Stream consumers</h3> <p>Stream consumers用のConnectorは、外部サービスとデータを連携する機能を持っている。</p> <p>Data importと何が違うかというと、Data importはバッチ処理のように特定のタイミングでしか処理が行われてないのに対し、Stream consumersはPub/Subモデルのような形で延々と処理が行われる。</p> <p>SIEMやEDRとの連携にはStream consumersが使用される。</p> <h3 id="enrichment"><a href="#enrichment" class="header-anchor">#</a> Enrichment</h3> <p>Enrichment用のConnectorは、observablesをエンリッチメントする機能を持っている。</p> <p>例えば、VirusTotalのConnectorは、ファイルのハッシュ値を元に、VirusTotalから情報を取得してobservableをエンリッチしてくれる。</p> <p><code>File</code>タイプのobservableを登録すると、下記のように<code>Labels</code>に情報が追加される。</p> <p><img src="https://i.imgur.com/Ptgegu4.png" alt=""></p> <p>何をキーにしてどのようにエンリッチメントが行われるのかは、実際にConnectorを動かしてみるか、ソースコードを確認してみないと分からない。</p> <p>VirusTotalの場合、自分はIP addressをキーにしてPassive DNSの情報をエンリッチしてくれることを勝手に期待していた。が、実際は<code>File</code>タイプのobservableをエンリッチすることしかできない。しかもやってくれることは、tagsを<code>Labels</code>にマッピングしてくれるだけだ。</p> <p><img src="https://i.imgur.com/skvH4FF.png" alt=""></p> <p>他の種類のConnectorにも言えることだが、事前にソースコードやドキュメントを確認しておくのがいいだろう。</p> <h3 id="files-import"><a href="#files-import" class="header-anchor">#</a> Files import</h3> <p>Files import用のConnectorは、ファイルからデータをインポートする機能を持っている。</p> <p>例えば、<code>ImportFilePdfObservables</code>Connectorを使用してPDFからobservablesを抽出してみるとこうなる。</p> <p><img src="https://i.imgur.com/qICbh25.png" alt=""></p> <p><img src="https://i.imgur.com/3iUAx81.png" alt=""></p> <p>ちなみに、<code>cert.gov</code>のような値は予めwhitelistというかdeny-listに入れておいてもらいたいものだが、そういった機能は無いようだ。</p> <h3 id="file-export"><a href="#file-export" class="header-anchor">#</a> File export</h3> <p>File export用のConnectorは、データをエクスポートする機能を持っている。</p> <p>OpenCTI内のデータを、例えばCSVやSTIX形式でエクスポートすることができる。</p> <h2 id="利用方法"><a href="#利用方法" class="header-anchor">#</a> 利用方法</h2> <p>OpenCTIのデータモデルはSTIX2.1をベースにしているので、STIX2.1について最低限の知識が必要となる。</p> <p>以下の記事を斜め読みしておくくらいのことはしておいた方が良いだろう。</p> <ul><li><a href="https://oasis-open.github.io/cti-documentation/stix/intro.html" target="_blank" rel="noopener noreferrer">Introduction to STIX<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.notion.so/Data-model-4427344d93a74fe194d5a52ce4a41a8d" target="_blank" rel="noopener noreferrer">OpenCTI Data model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="web-ui"><a href="#web-ui" class="header-anchor">#</a> Web UI</h3> <p>Web UI上でデータの作成・参照ができる。</p> <p><img src="https://i.imgur.com/M0iztUE.png" alt=""></p> <p><img src="https://i.imgur.com/Gom7lwg.png" alt=""></p> <p><img src="https://i.imgur.com/s6vKDC8.png" alt=""></p> <p>どんなものなのか、デモにアクセスして試してみるのが一番分かりやすいだろう。</p> <ul><li><a href="https://demo.opencti.io/dashboard" target="_blank" rel="noopener noreferrer">https://demo.opencti.io/dashboard<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="graphql-api"><a href="#graphql-api" class="header-anchor">#</a> GraphQL API</h3> <p>GraphQLを使ってデータの作成・参照が行える。</p> <p>というか、GraphQL APIがOpenCTIの本体で、Web UIはReactベースのSPAでGraphQLを叩いているだけにすぎない。</p> <p><img src="https://i.imgur.com/fnUBC4s.png" alt=""></p> <p><code>/graphql</code>にGraphQL用のplaygroundが用意されているので、そこでGraphQLを実行してみることができる。</p> <p><img src="https://i.imgur.com/XUoAZYd.png" alt=""></p> <h2 id="まとめ-あるいはopenctiは実際どう使えるのか"><a href="#まとめ-あるいはopenctiは実際どう使えるのか" class="header-anchor">#</a> まとめ(あるいはOpenCTIは実際どう使えるのか)</h2> <p>OpenCTIを使うことで、STIX2.1をベースにしたThreat Intelligenceのナレッジ管理が行える。</p> <p>セキュリティベンダーやCERT-FR(ANSSI)のようなナショナルCSIRTはこういったナレッジの管理が業務の一つだからOpenCTIを使うことができるだろう。</p> <p>セキュリティベンダーやナショナルCSIRTでなくても、大きな組織であれば自前でインディケーターや検知ルールの管理を行っているだろう。そういったナレッジの管理にOpenCTIは使用できる。あるいはOpenCTIの導入を契機にしてインディケーターや検知ルールのナレッジ管理に挑戦してみることもできるだろう。</p> <p>余談になるが、OpenCTIに限らず言えることだけれどもThreat Intelligence Platform(TIP)というかThreat Intelligenceの定義は曖昧で、人によって定義や期待している効果が異なっていることが多い。</p> <p>予めどんなことがしたいのか、どんな効果が期待されるのか、どうやって効果測定を行うのか決めてから　TIPを導入しないと、どのようなものであっても無用の長物になるだけだろう。</p> <h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <ul><li><a href="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a435a173-bbfd-4dd8-99a7-1924b78945a6/20200415_OpenCTI_Webinar_001.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210416%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20210416T012752Z&amp;X-Amz-Expires=86400&amp;X-Amz-Signature=b6bea7fedf34d69818725d5140fc3bd7c9025a1144dedc97c87bc03c24ebf8ee&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=filename%20%3D%2220200415_OpenCTI_Webinar_001.pdf%22" target="_blank" rel="noopener noreferrer">OpenCTI Introduction to the platform &amp; next steps / Luatix (PDF)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.oasis-open.org/committees/download.php/68107/20201217_OpenCTI_OASIS-CTI-TC.pdf" target="_blank" rel="noopener noreferrer">OpenCTI &amp; SITX / Luatix (PDF)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.ssi.gouv.fr/uploads/2019/10/anssi-doctrine_opencti-v1.0.pdf" target="_blank" rel="noopener noreferrer">Integration of Information in OpenCTI / CERT-FR (PDF)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://threatintelblog.files.wordpress.com/2021/01/sans_cti_summit_2021_andreas_sfakianakis.pdf" target="_blank" rel="noopener noreferrer">Still thinking about your Ex(cel)? Here are some TIPs / SANS CTI Summit 2021 (PDF)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="おまけ-oss-tip-matrix"><a href="#おまけ-oss-tip-matrix" class="header-anchor">#</a> おまけ(OSS TIP matrix)</h2> <p><img src="https://i.imgur.com/eXhWqQj.jpg" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.c8db5b8a.js" defer></script><script src="/assets/js/2.551672f8.js" defer></script><script src="/assets/js/31.924c0225.js" defer></script>
  </body>
</html>
